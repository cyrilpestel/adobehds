
## Convertir un fichier flv en mp4 ##
avconv -i 7a77e018df5a03ba3d470504bb3e3977_690ce18c54067c0876c2ebbd56f99688_Seg1-Frag.flv -codec copy "Doublement Marianne - S01E30.mp4"

## Télécharger une video au format flv ##
ruby run.rb 'php AdobeHDS.php --manifest "http://web.q1.tf1.fr/2/USP-0x0/37/48/12973748/ssm/12973748.ism/12973748.f4m?vk=MTI5NzM3NDguZjRt&st=xec3RuXYtJeyXBbUiYtExw&e=1458373206&t=1458243606&bu=TFOU&login=robin-des-bois-tfou&i=109.221.133.144&u=a4aedc160f4db1107389aac31a34e732&sum=5a0a44755960214f1b01e6ea550de796&min_bitrate=700000&max_bitrate=2000000&seek=wat&hdcore=2.11.3&g=HWYXWVCADHPV" --delete --auth "vk=MTI5NzM3NDguZjRt&st=xec3RuXYtJeyXBbUiYtExw&e=1458373206&t=1458243606&bu=TFOU&login=robin-des-bois-tfou&i=109.221.133.144&u=a4aedc160f4db1107389aac31a34e732&sum=5a0a44755960214f1b01e6ea550de796&min_bitrate=700000&max_bitrate=2000000&seek=wat&als=0,2,0,1,0,NaN,0,0,0,127,f,0,659.52,f,s,HWYXWVCADHPV,2.11.3,127&hdcore=2.11.3" --useragent "Mozilla/5.0 (X11; Linux x86_64; rv:42.0) Gecko/20100101 Firefox/42.0"' "La flèche magique" "2"

php AdobeHDS.php --manifest "http://web.q1.tf1.fr/2/USP-0x0/02/59/12980259/ssm/12980259.ism/12980259.f4m?vk=MTI5ODAyNTkuZjRt&st=yksx3cZ2xTPsg06ojvxzvw&e=1460859428&t=1460729828&bu=TFOU&login=mini-ninjas&i=90.126.57.100&u=a4aedc160f4db1107389aac31a34e732&sum=04ac0c6c8456b0696bc3d459fda8b811&min_bitrate=700000&max_bitrate=2000000&seek=wat&hdcore=2.11.3&g=OBBNQIFOJLOO" --delete --auth "vk=MTI5ODAyNTkuZjRt&st=yksx3cZ2xTPsg06ojvxzvw&e=1460859428&t=1460729828&bu=TFOU&login=mini-ninjas&i=90.126.57.100&u=a4aedc160f4db1107389aac31a34e732&sum=04ac0c6c8456b0696bc3d459fda8b811&min_bitrate=700000&max_bitrate=2000000&seek=wat&als=0,2,0,1,0,NaN,0,0,0,41,f,0,630,f,s,OBBNQIFOJLOO,2.11.3,41&hdcore=2.11.3" --useragent "Mozilla/5.0 (X11; Linux x86_64; rv:42.0) Gecko/20100101 Firefox/42.0"


## Télécharger une video de mini-ninjas au format flv ##

php AdobeHDS.php --manifest "http://web.q1.tf1.fr/2/USP-0x0/38/37/12983837/ssm/12983837.ism/12983837.f4m?vk=MTI5ODM4MzcuZjRt&st=U4-uXl5XYcQPjZhjMGQsgw&e=1461029638&t=1460900038&bu=TFOU&login=mini-ninjas&i=90.126.57.100&u=a4aedc160f4db1107389aac31a34e732&sum=04ac0c6c8456b0696bc3d459fda8b811&min_bitrate=700000&max_bitrate=2000000&seek=wat&hdcore=2.11.3&g=JICNUIZXWGVN" --delete --auth "vk=MTI5ODM4MzcuZjRt&st=U4-uXl5XYcQPjZhjMGQsgw&e=1461029638&t=1460900038&bu=TFOU&login=mini-ninjas&i=90.126.57.100&u=a4aedc160f4db1107389aac31a34e732&sum=04ac0c6c8456b0696bc3d459fda8b811&min_bitrate=700000&max_bitrate=2000000&seek=wat&als=0,2,0,1,0,NaN,0,0,0,26,f,0,629.12,f,s,JICNUIZXWGVN,2.11.3,26&hdcore=2.11.3" --useragent "Mozilla/5.0 (X11; Linux x86_64; rv:42.0) Gecko/20100101 Firefox/42.0"

** TFou

php AdobeHDS.php --manifest "http://tf1vodhdscatchup-vh.akamaihd.net/z/H264-384x288/53/79/12755379.h264/manifest.f4m?hdnea=st=1463415699~exp=1463417499~acl=/*~hmac=e98fdd963e70c3e0641b92aca6e493d6c8131dab02b06702a322f3f45e8e8b57&bu=WAT&login=tfm0389-mini-ninjas&i=90.126.57.100&u=a4aedc160f4db1107389aac31a34e732&sum=04ac0c6c8456b0696bc3d459fda8b811&hdcore=2.11.3&g=FCEOUHNVSRIG" --delete --auth "pvtoken=exp%3D9999999999%7Eacl%3D%252f%252a%7Edata%3DZXhwPTE0NjM1MDIxMDB+YWNsPSUyZip+ZGF0YT1wdmMsc35obWFjPWNmMGZhM2JmYmVhYTBkM2VjYTMwMWU0ZjI1NTI5NzYyYTAxNTJlOTFlOTQ3MTk5N2VkN2NhZTM3MWQxZWQyY2E%3D%2147DEQpj8HBSa+/TImW+5JCeuQeRkm5NMpJWZG3hSuFU%3D%7Ehmac%3DA47329D2DFA9AA229082463583331C08FE71EC34D62FCDE7300A7E48BD333F6A&hdntl=exp=1463502100~acl=%2f*~data=hdntl~hmac=7eb77918cf17a83c60b48137b8a233a0e01047f7fc96bc44c8aab490b9b7b097&bu=WAT&login=tfm0389-mini-ninjas&i=90.126.57.100&u=a4aedc160f4db1107389aac31a34e732&sum=04ac0c6c8456b0696bc3d459fda8b811&als=0,2,0,0,0,NaN,0,0,0,37,f,0,663,f,s,FCEOUHNVSRIG,2.11.3,37&hdcore=2.11.3" --useragent "Mozilla/5.0 (X11; Linux x86_64; rv:42.0) Gecko/20100101 Firefox/42.0"

** url **

http://web.q1.tf1.fr/2/USP-0x0/38/37/12983837/ssm/12983837.ism/12983837.f4m?vk=MTI5ODM4MzcuZjRt&st=U4-uXl5XYcQPjZhjMGQsgw&e=1461029638&t=1460900038&bu=TFOU&login=mini-ninjas&i=90.126.57.100&u=a4aedc160f4db1107389aac31a34e732&sum=04ac0c6c8456b0696bc3d459fda8b811&min_bitrate=700000&max_bitrate=2000000&seek=wat&hdcore=2.11.3&g=JICNUIZXWGVN

** A partir d'une url **

php AdobeHDS.php --delete --manifest "<url>" --auth "<url>&als=0,2,0,1,0,NaN,0,0,0,36,f,0,660,f,s,UDIIHDKRBYRM,2.11.3,36" --useragent "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.110 Safari/537.36"


## Télécharger une video de heidi au format flv ##

php AdobeHDS.php --manifest "http://web.q1.tf1.fr/2/USP-0x0/39/16/12983916/ssm/12983916.ism/12983916.f4m?vk=MTI5ODM5MTYuZjRt&st=THi63w2mpD9KCvG-NoM3UQ&e=1461030732&t=1460901132&bu=TFOU&login=heidi-tfou&i=90.126.57.100&u=a4aedc160f4db1107389aac31a34e732&sum=04ac0c6c8456b0696bc3d459fda8b811&min_bitrate=700000&max_bitrate=2000000&seek=wat&hdcore=2.11.3&g=ISBQNEIHITHY" --delete --auth "vk=MTI5ODM5MTYuZjRt&st=THi63w2mpD9KCvG-NoM3UQ&e=1461030732&t=1460901132&bu=TFOU&login=heidi-tfou&i=90.126.57.100&u=a4aedc160f4db1107389aac31a34e732&sum=04ac0c6c8456b0696bc3d459fda8b811&min_bitrate=700000&max_bitrate=2000000&seek=wat&als=0,3,0,1,0,NaN,0,0,0,41,f,0,1260,f,s,ISBQNEIHITHY,2.11.3,41&hdcore=2.11.3" --useragent "Mozilla/5.0 (X11; Linux x86_64; rv:42.0) Gecko/20100101 Firefox/42.0"

** url **

http://web.q1.tf1.fr/2/USP-0x0/39/16/12983916/ssm/12983916.ism/12983916.f4m?vk=MTI5ODM5MTYuZjRt&st=THi63w2mpD9KCvG-NoM3UQ&e=1461030732&t=1460901132&bu=TFOU&login=heidi-tfou&i=90.126.57.100&u=a4aedc160f4db1107389aac31a34e732&sum=04ac0c6c8456b0696bc3d459fda8b811&min_bitrate=700000&max_bitrate=2000000&seek=wat&hdcore=2.11.3&g=ISBQNEIHITHY

** A partir d'une url **

php AdobeHDS.php --delete --manifest "<url>" --auth "<url>&als=0,3,0,1,0,NaN,0,0,0,41,f,0,1260,f,s,ISBQNEIHITHY,2.11.3,41" --useragent "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.110 Safari/537.36"

php AdobeHDS.php --delete --manifest "http://web.q1.tf1.fr/2/USP-0x0/39/16/12983916/ssm/12983916.ism/12983916.f4m?vk=MTI5ODM5MTYuZjRt&st=THi63w2mpD9KCvG-NoM3UQ&e=1461030732&t=1460901132&bu=TFOU&login=heidi-tfou&i=90.126.57.100&u=a4aedc160f4db1107389aac31a34e732&sum=04ac0c6c8456b0696bc3d459fda8b811&min_bitrate=700000&max_bitrate=2000000&seek=wat&hdcore=2.11.3&g=ISBQNEIHITHY" --auth "vk=MTI5ODM5MTYuZjRt&st=THi63w2mpD9KCvG-NoM3UQ&e=1461030732&t=1460901132&bu=TFOU&login=heidi-tfou&i=90.126.57.100&u=a4aedc160f4db1107389aac31a34e732&sum=04ac0c6c8456b0696bc3d459fda8b811&min_bitrate=700000&max_bitrate=2000000&seek=wat&hdcore=2.11.3&g=ISBQNEIHITHY&als=0,3,0,1,0,NaN,0,0,0,41,f,0,1260,f,s,ISBQNEIHITHY,2.11.3,41" --useragent "Mozilla/5.0 (X11; Linux x86_64; rv:42.0) Gecko/20100101 Firefox/42.0"

** A partir de TFouMax avec un Firefox Mac **

php AdobeHDS.php --manifest "http://tf1vodhdscatchup-vh.akamaihd.net/z/H264-384x288/75/89/12907589.h264/manifest.f4m?hdnea=st=1463568425~exp=1463570225~acl=/*~hmac=0f617cef8d0c1677dafdc3fe172d67affe601f07c8b2a534af42250d9a72d12d&bu=WAT&login=tfm0318-heidi&i=90.126.57.100&u=cf20b503e4ef4d37f6b9aac9e62c1faa&sum=4446bcdab7167922c2faa3c7d6835e55&hdcore=2.11.3&g=TFQFYXMEPZBC" --delete --auth "pvtoken=exp%3D9999999999%7Eacl%3D%252f%252a%7Edata%3DZXhwPTE0NjM2NTQ4MjV+YWNsPSUyZip+ZGF0YT1wdmMsc35obWFjPTdiZmI1Y2RmZTAxNzZkNjE3NDlkYjA0YTQ4YmEyYzIyMDIyZTA5NzA0OWZjYTI2Y2MwOGU1MmQ3NWE5YjFhYTA%3D%21dLiI/VkZ8lgyYaau3IcgVUBFrAbEk2qmwY6+VSa5O4w%3D%7Ehmac%3D7DBDF19BE50FA306D66B30EE885309E9639732D238A5098555C6A4A1C0883ACF&hdntl=exp=1463654825~acl=%2f*~data=hdntl~hmac=674129afc4ca656e5010f1a9dac36a509d1d8daf240303c977424182d11e0b8b&bu=WAT&login=tfm0318-heidi&i=90.126.57.100&u=cf20b503e4ef4d37f6b9aac9e62c1faa&sum=4446bcdab7167922c2faa3c7d6835e55&als=0,2,0,0,0,NaN,0,0,0,64,f,0,1295,f,s,TFQFYXMEPZBC,2.11.3,64&hdcore=2.11.3" --useragent "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:45.0) Gecko/20100101 Firefox/45.0"



## Télécharger une video de mini-ninjas ##

php AdobeHDS.php --manifest "http://web.q1.tf1.fr/2/USP-0x0/43/22/12984322/ssm/12984322.ism/12984322.f4m?vk=MTI5ODQzMjIuZjRt&st=zTw7RajOop4yyY5Nzk1yEw&e=1461140553&t=1461010953&bu=TFOU&login=mini-ninjas&i=90.126.57.100&u=a4aedc160f4db1107389aac31a34e732&sum=04ac0c6c8456b0696bc3d459fda8b811&min_bitrate=400000&max_bitrate=1000000&seek=wat&hdcore=2.11.3&g=SMKMAJBWFQEP" --delete --auth "vk=MTI5ODQzMjIuZjRt&st=zTw7RajOop4yyY5Nzk1yEw&e=1461140553&t=1461010953&bu=TFOU&login=mini-ninjas&i=90.126.57.100&u=a4aedc160f4db1107389aac31a34e732&sum=04ac0c6c8456b0696bc3d459fda8b811&min_bitrate=400000&max_bitrate=1000000&seek=wat&als=0,2,0,1,0,NaN,0,0,0,125,f,0,629.12,f,s,SMKMAJBWFQEP,2.11.3,125&hdcore=2.11.3" --useragent "Mozilla/5.0 (X11; Linux x86_64; rv:42.0) Gecko/20100101 Firefox/42.0"

## Télécharger une video de vic le viking ##

php AdobeHDS.php --manifest "http://web.q1.tf1.fr/2/USP-0x0/29/07/12992907/ssm/12992907.ism/12992907.f4m?vk=MTI5OTI5MDcuZjRt&st=emNa6WDQBMtVUk3J29-JaQ&e=1463125440&t=1462995840&bu=TFOU&login=vic-le-viking-tfoufr&i=90.126.57.100&u=a4aedc160f4db1107389aac31a34e732&sum=04ac0c6c8456b0696bc3d459fda8b811&min_bitrate=700000&max_bitrate=2000000&seek=wat&hdcore=2.11.3&g=RBIQKMGKCAQZ" --delete --auth "vk=MTI5OTI5MDcuZjRt&st=emNa6WDQBMtVUk3J29-JaQ&e=1463125440&t=1462995840&bu=TFOU&login=vic-le-viking-tfoufr&i=90.126.57.100&u=a4aedc160f4db1107389aac31a34e732&sum=04ac0c6c8456b0696bc3d459fda8b811&min_bitrate=700000&max_bitrate=2000000&seek=wat&als=0,3,0,1,0,NaN,0,0,0,128,f,0,673.56,f,s,RBIQKMGKCAQZ,2.11.3,128&hdcore=2.11.3" --useragent "Mozilla/5.0 (X11; Linux x86_64; rv:42.0) Gecko/20100101 Firefox/42.0"

## Télécharger une video de dora and friends ##

php AdobeHDS.php --manifest "http://web.q1.tf1.fr/2/USP-0x0/28/93/12992893/ssm/12992893.ism/12992893.f4m?vk=MTI5OTI4OTMuZjRt&st=s_0Uc4Za__gf002uFJzseA&e=1463358807&t=1463229207&bu=TFOU&login=tfou-dora-and-friends-sur-tfou&i=90.126.57.100&u=a4aedc160f4db1107389aac31a34e732&sum=04ac0c6c8456b0696bc3d459fda8b811&min_bitrate=700000&max_bitrate=2000000&seek=wat&hdcore=2.11.3&g=COTYSILRQGDO" --delete --auth "vk=MTI5OTI4OTMuZjRt&st=s_0Uc4Za__gf002uFJzseA&e=1463358807&t=1463229207&bu=TFOU&login=tfou-dora-and-friends-sur-tfou&i=90.126.57.100&u=a4aedc160f4db1107389aac31a34e732&sum=04ac0c6c8456b0696bc3d459fda8b811&min_bitrate=700000&max_bitrate=2000000&seek=wat&als=0,2,0,1,0,NaN,0,0,0,127,f,0,1330.44,f,s,COTYSILRQGDO,2.11.3,127&hdcore=2.11.3" --useragent "Mozilla/5.0 (X11; Linux x86_64; rv:42.0) Gecko/20100101 Firefox/42.0"

==== Robin des bois =====

./run.rb -c '<CMD>' -w "Robin des bois" -i "robin-des-bois" -t "Les cinq marionnettes" -e "29"

==== Mike le chevalier =====

./run.rb -c '<CMD>' -t 'Mike le Chevalier et les objets précieux de Chevalier' -e "34" -s "02" -w "Mike le chevalier" -a -i 'mike-le-chevalier'

==== Heidi =====

./run.rb -c '<CMD>' -w "Heidi" -i "heidi" -t "La lettre" -e "26" -a


==== Mini-ninjas ====

./run.rb -c '<CMD>' -w "Mini Ninjas" -i "mini-ninjas" -t "Suzume contre Suzume" -e "16" -a


Méthode

1. sudo ruby PacketFilter.rb --> url_download
2. ruby TF1SearchProvider.rb <url> --> options
3. ./run.rb -u "<url_download>" <options>

Nouvelle méthode :

sudo ruby run.rb -u ""

Rechercher :

ruby search_tf1.rb robin-des-bois
ruby search_tf1.rb mini-ninjas
ruby search_tf1.rb heidi
